# 专家评价对比组件

## 概述

专家评价对比组件 (`ExpertCompareDialog`) 是一个功能强大的对话框组件，用于对比分析多位专家的评审意见。该组件提供了三个主要分析维度：总览对比、详细对比（审查工作表）、一致性分析。

## 主要功能

### 1. 总览对比
- **评审结果分布**：统计各专家的评审结果（同意/修改后同意/不同意）
- **评分分析**：显示平均评分、最高评分、最低评分和评分差异
- **专业领域覆盖**：展示参与评审专家的专业领域分布

### 2. 详细对比（审查工作表）⭐ **新功能**
专门针对审查工作表的详细对比分析，支持：

#### 核心功能
- **评审标准对比**：展示每位专家对每条评审标准的具体评审结果
- **智能过滤系统**：
  - 按分类过滤（研究设计、受试者保护、风险管理、数据管理等）
  - 按结果类型过滤（全部同意、全部不同意、全部不适用、存在分歧）
- **冲突识别**：自动识别专家意见存在分歧的评审标准
- **一致性标识**：标记专家意见完全一致的评审标准

#### 数据展示
- **表格化对比**：清晰展示每位专家对每条标准的评审结果和备注
- **统计汇总**：显示每条标准的结果分布统计
- **视觉标识**：
  - 🟢 同意：绿色标识
  - 🔴 不同意：红色标识  
  - ⚪不适用：灰色标识
  - ⚠️ 存在分歧：橙色边框和警告标识

#### 快速操作
- **一键过滤**：对于存在分歧的标准，可快速过滤查看特定结果
- **结果统计**：实时显示过滤后的标准数量

### 3. 一致性分析
- **一致性评估**：基于评审结果和评分差异的综合评估
- **高频关键词**：词云展示专家意见中的高频关键词
- **分歧点分析**：识别和分析专家意见的主要分歧点

## 审查工作表数据结构

```typescript
interface ReviewCriteriaResult {
  criteriaId: string;        // 标准ID
  criteriaName: string;      // 标准名称
  category: string;          // 分类（研究设计、受试者保护等）
  description: string;       // 标准描述
  result: "同意" | "不同意" | "不适用";  // 评审结果
  comment?: string;          // 备注信息
}
```

## 使用示例

```tsx
import ExpertCompareDialog from './expert-compare-dialog';

// 基本使用
<ExpertCompareDialog
  isOpen={isOpen}
  onClose={() => setIsOpen(false)}
  expertOpinions={expertOpinions}
  onExport={(data) => {
    // 处理导出数据
    console.log("导出对比报告", data);
  }}
/>
```

## 模拟数据

组件内置了8条模拟评审标准，涵盖4个主要分类：

1. **研究设计**
   - 研究目的明确性
   - 研究方法科学性

2. **受试者保护**
   - 受试者招募程序
   - 知情同意书完整性

3. **风险管理**
   - 风险效益评估
   - 不良事件处理

4. **数据管理**
   - 数据安全保护
   - 隐私保护措施

## 过滤功能详解

### 分类过滤
- **所有分类**：显示全部评审标准
- **研究设计**：仅显示研究设计相关标准
- **受试者保护**：仅显示受试者保护相关标准
- **风险管理**：仅显示风险管理相关标准
- **数据管理**：仅显示数据管理相关标准

### 结果类型过滤
- **所有结果**：显示全部标准
- **全部同意**：仅显示所有专家都选择"同意"的标准
- **全部不同意**：仅显示所有专家都选择"不同意"的标准
- **全部不适用**：仅显示所有专家都选择"不适用"的标准
- **存在分歧**：仅显示专家意见不一致的标准

## 技术特性

- **响应式设计**：支持各种屏幕尺寸
- **实时过滤**：过滤条件变化时实时更新显示结果
- **智能分析**：自动分析专家意见的一致性和分歧点
- **导出功能**：支持导出完整的对比分析报告
- **无障碍支持**：良好的键盘导航和屏幕阅读器支持

## 最佳实践

1. **数据准备**：确保每位专家的 `reviewCriteria` 数据完整
2. **过滤使用**：优先使用"存在分歧"过滤器快速定位需要关注的标准
3. **导出时机**：在完成对比分析后及时导出报告备档
4. **性能考虑**：大量专家（>10位）时建议分批对比

## 注意事项

- 组件要求至少2位专家才能进行对比分析
- 模拟数据仅用于演示，实际使用时需要提供真实的审查工作表数据
- 过滤功能是客户端实现，大数据量时可能需要服务端支持
- 导出功能需要根据实际需求实现具体的导出逻辑

## 扩展功能

未来可以考虑添加的功能：
- 批量操作（批量标记、批量导出等）
- 历史对比（与之前版本的对比）
- 自定义评审标准模板
- 专家权重设置
- 更多图表可视化选项 