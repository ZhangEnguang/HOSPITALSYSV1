# 仪器预约编辑页面功能说明

## 概述
本页面为仪器预约的编辑功能，允许用户修改已提交的预约申请。该页面基于原始预约页面代码开发，保持了完整的功能和用户体验。

## 主要功能

### 1. 预约数据加载
- 自动根据URL参数中的预约ID加载现有预约数据
- 预填充所有表单字段（预约人、部门、电话、目的、项目、备注等）
- 自动设置已选择的时间段
- 将日历定位到预约日期

### 2. 编辑功能
- 支持修改预约人信息
- 支持修改预约时间（重新选择时间段）
- 支持修改使用目的和项目关联
- 支持修改备注说明
- 保持所有AI辅助功能（时间推荐、项目建议等）

### 3. 数据验证
- 保持与原预约页面相同的验证规则
- 必填字段验证：预约人、所属单位、使用目的、联系电话
- 时间段选择验证

### 4. 用户体验
- 页面标题显示为"编辑预约"
- 显示当前编辑的预约概览信息（预约编号、设备名称、原始时间、状态）
- 提交按钮文字为"更新预约"
- 成功更新后跳转到预约管理页面

### 5. 错误处理
- 当预约ID不存在时显示友好的错误页面
- 提供返回预约管理页面的快捷链接

## 使用方法

### 从预约管理页面进入
1. 在仪器预约管理页面的操作列中点击"编辑预约"按钮
2. 系统会跳转到 `/laboratory/equipment-booking/edit/{预约ID}` 页面
3. 页面会自动加载对应预约的所有信息

### 编辑预约
1. 页面会显示当前预约的基本信息概览
2. 所有表单字段会自动填充现有数据
3. 时间选择器会显示当前已选择的时间段
4. 可以修改任何字段和重新选择时间
5. 点击"更新预约"保存修改

### 测试数据
系统内置了10个测试预约数据：
- `book-001`: XPS（X射线光电子能谱分析）预约 - 纳米颗粒表征实验
- `book-002`: 普通广角XRD（X射线衍射仪）预约 - 蛋白质结构分析
- `book-003`: 单晶（顶级解析专家）预约 - 光谱测量实验
- `book-004`: XRD（微区测试）预约 - 细胞培养观察
- `book-005`: 电子探针（EPMA）预约 - 金属成分检测
- `book-006`: 紫外光电子能谱（UPS）预约 - 电化学性能测试
- `book-007`: 拉曼光谱仪预约 - 热分析实验
- `book-008`: 气相色谱-质谱联用仪预约 - 气相色谱分析
- `book-009`: 万能试验机预约 - 力学性能测试
- `book-010`: 核磁共振波谱仪预约 - 核磁共振波谱测定

所有测试数据都支持完整的编辑功能。

可以通过访问以下URL进行测试：
- `/laboratory/equipment-booking/edit/book-001`
- `/laboratory/equipment-booking/edit/book-002`

## 技术实现

### 数据模拟
- 使用 `mockExistingBookings` 对象模拟现有预约数据
- 通过 `getExistingBookingData()` 函数根据ID获取预约数据
- 支持扩展，可以轻松替换为真实的API调用

### 状态管理
- 使用 `useEffect` 在组件加载时填充现有数据
- 保持与原页面相同的状态结构和逻辑
- 自动设置时间段和日历位置

### 表单处理
- 修改了 `handleSubmit` 函数以处理更新逻辑
- 更新成功后跳转到预约管理页面
- 保持相同的验证规则和错误处理

## 与原预约页面的区别

1. **页面标题**: "仪器预约" → "编辑预约"
2. **数据加载**: 新增现有预约数据的加载和预填充功能
3. **提交按钮**: "提交预约" → "更新预约"
4. **提交逻辑**: "预约成功" → "预约更新成功"
5. **跳转目标**: `/laboratory/equipment` → `/laboratory/equipment-booking`
6. **页面概览**: 新增预约信息概览显示

## 注意事项

1. 该页面不会影响原始预约功能的任何逻辑
2. 所有AI功能和用户体验保持一致
3. 编辑后的预约状态可能需要重新审核
4. 建议在生产环境中替换模拟数据为真实API调用 